# ğŸ”§ í”„ë¡œì íŠ¸ ì•„í‚¤í…ì²˜: ë¬´ì‹ ì‚¬ í¬ë¡¤ë§ ë°ì´í„° íŒŒì´í”„ë¼ì¸
> **For Senior Developers** - ì‹œë‹ˆì–´ ê°œë°œì ê´€ì ì˜ ê¸°ìˆ ì  ë¶„ì„

---

## ğŸ“Œ Executive Summary

E-commerce ìƒí’ˆ ë°ì´í„° ìˆ˜ì§‘ ë° ê²€ìƒ‰ íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ, **Batch Processing(Airflow)** ê³¼ **Real-Time Streaming(Kafka)** ì„ í†µí•©í•œ **Lambda Architecture** ê¸°ë°˜ì˜ ë°ì´í„° ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### í•µì‹¬ ì„¤ê³„ ì›ì¹™
- **Polyglot Persistence**: ìš©ë„ë³„ ìµœì í™”ëœ ì €ì¥ì†Œ ì„ íƒ (RDBMS + ê²€ìƒ‰ì—”ì§„)
- **Decoupled Architecture**: Kafkaë¥¼ í†µí•œ Producer/Consumer ë¶„ë¦¬
- **Idempotent Processing**: UPSERT íŒ¨í„´ìœ¼ë¡œ ì¤‘ë³µ ì²˜ë¦¬ ì•ˆì „ì„± í™•ë³´

---

## ğŸ›ï¸ System Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                              Data Collection Layer                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                                        â”‚
â”‚  â”‚  Playwright     â”‚  Headless Browser Automation                           â”‚
â”‚  â”‚  (Chromium)     â”‚  - Anti-bot bypass                                     â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜  - JavaScript rendering                                â”‚
â”‚           â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              Orchestration Layer                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  Apache Airflow â”‚ â”€â”€â”€â†’ â”‚  Kafka Cluster  â”‚ â†â”€â”€â”€ â”‚  Zookeeper      â”‚      â”‚
â”‚  â”‚  (Scheduler)    â”‚      â”‚  (Broker)       â”‚      â”‚  (Coordinator)  â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                    â”‚                                         â”‚
â”‚         Batch Processing           â”‚     Real-Time Streaming                 â”‚
â”‚                                    â–¼                                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              Storage Layer                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚
â”‚  â”‚  PostgreSQL 15  â”‚      â”‚  OpenSearch     â”‚      â”‚  Redis 7        â”‚      â”‚
â”‚  â”‚  (OLTP)         â”‚      â”‚  (Full-Text)    â”‚      â”‚  (Cache)        â”‚      â”‚
â”‚  â”‚   - ì›ë³¸ ë°ì´í„°   â”‚      â”‚   - ì—­ì¸ë±ìŠ¤     â”‚      â”‚   - Query Cache â”‚      â”‚
â”‚  â”‚   - UPSERT      â”‚      â”‚   - Nori ë¶„ì„ê¸°  â”‚      â”‚   - TTL 300s    â”‚      â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚
â”‚                                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                              API Layer                                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  FastAPI (ASGI)                                                     â”‚    â”‚
â”‚  â”‚   - RESTful CRUD APIs                                               â”‚    â”‚
â”‚  â”‚   - Cache-Aside Pattern (Redis)                                     â”‚    â”‚
â”‚  â”‚   - Swagger/OpenAPI 3.0 ìë™ ìƒì„±                                    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Tech Stack Deep Dive

### Data Collection
| Component | Version | Purpose | Implementation Details |
|-----------|---------|---------|------------------------|
| **Playwright** | 1.56.0 | Web Scraping | Async context, headless Chromium, human-like delays, cookie/session management |

### Data Storage (Polyglot Persistence)
| Component | Version | Purpose | Implementation Details |
|-----------|---------|---------|------------------------|
| **PostgreSQL** | 15 | OLTP, Source of Truth | SQLAlchemy 2.0 ORM, UPSERT with `ON CONFLICT` |
| **OpenSearch** | 2.11.0 | Full-Text Search | Nori analyzer (Korean morphology), Bulk indexing |
| **Redis** | 7-alpine | Query Cache | Cache-aside pattern, JSON serialization, 300s TTL |

### Message Queue (Event Streaming)
| Component | Version | Purpose | Implementation Details |
|-----------|---------|---------|------------------------|
| **Kafka** | 7.5.0 (Confluent) | Event Bus | 3 partitions, at-least-once delivery, JSON serializer |
| **Zookeeper** | 7.5.0 | Cluster Coordination | Kafka metadata management |

### Workflow Orchestration
| Component | Version | Purpose | Implementation Details |
|-----------|---------|---------|------------------------|
| **Apache Airflow** | 2.7+ | DAG Scheduling | `PythonOperator`, XCom data passing, Retry with exponential backoff |

### API Server
| Component | Version | Purpose | Implementation Details |
|-----------|---------|---------|------------------------|
| **FastAPI** | Latest | REST API | ASGI (Uvicorn), Pydantic validation, CORS middleware |
| **SQLAlchemy** | 2.0.23 | ORM | Session management, declarative mapping |
| **Pydantic** | 2.5.0 | Schema Validation | Request/Response models, nested object handling |

### Infrastructure
| Component | Version | Purpose | Implementation Details |
|-----------|---------|---------|------------------------|
| **Docker Compose** | 3 | Container Orchestration | 9 services, named networks, volume persistence |

---

## ğŸ“‚ Codebase Structure

```
c:\Crawling\
â”‚
â”œâ”€â”€ src/                           # Application Logic
â”‚   â”œâ”€â”€ api_server.py              # FastAPI entry point (CRUD + Search)
â”‚   â”œâ”€â”€ v2.2_crawler.py            # Playwright crawler (dual-save version)
â”‚   â”œâ”€â”€ cache.py                   # Redis cache utilities
â”‚   â”œâ”€â”€ init_opensearch.py         # Index creation with Nori analyzer
â”‚   â”‚
â”‚   â”œâ”€â”€ database/                  # Data Layer
â”‚   â”‚   â”œâ”€â”€ connection.py          # SQLAlchemy engine factory
â”‚   â”‚   â”œâ”€â”€ models.py              # ORM models (Product, Seller)
â”‚   â”‚   â””â”€â”€ schemas.py             # Pydantic DTOs
â”‚   â”‚
â”‚   â”œâ”€â”€ routers/                   # API Routes
â”‚   â”‚   â””â”€â”€ products.py            # Product CRUD endpoints
â”‚   â”‚
â”‚   â”œâ”€â”€ tasks/                     # Airflow Task Modules
â”‚   â”‚   â”œâ”€â”€ crawl_task.py          # Collection logic
â”‚   â”‚   â”œâ”€â”€ validate_task.py       # Data validation
â”‚   â”‚   â”œâ”€â”€ load_task.py           # Dual storage (PG + OS)
â”‚   â”‚   â””â”€â”€ xcom_utils.py          # XCom optimization (file vs memory)
â”‚   â”‚
â”‚   â””â”€â”€ kafka_client/              # Kafka Integration
â”‚       â”œâ”€â”€ config.py              # Broker/Topic configuration
â”‚       â”œâ”€â”€ producer.py            # KafkaProducer wrapper
â”‚       â”œâ”€â”€ consumer.py            # Consumer base class
â”‚       â”œâ”€â”€ consumer_postgres.py   # PG-specific consumer
â”‚       â””â”€â”€ consumer_opensearch.py # OS-specific consumer
â”‚
â”œâ”€â”€ airflow/
â”‚   â”œâ”€â”€ dags/                      # DAG Definitions
â”‚   â”œâ”€â”€ docker-compose.yml         # Airflow-specific compose
â”‚   â””â”€â”€ Dockerfile                 # Custom image with Playwright
â”‚
â”œâ”€â”€ docker-compose.yml              # Main infrastructure compose
â”œâ”€â”€ requirements.txt                # Python dependencies
â””â”€â”€ WEEK_[1-3]_ì‹¤í–‰ë°©ë²•.md          # Documentation
```

---

## ğŸ”€ Data Flow Patterns

### Pattern 1: Batch ETL (Airflow)
```
[Airflow Scheduler] 
    â”‚ cron: 0 9 * * *
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     XCom/File     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     XCom/File     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ crawl_task  â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚validate_taskâ”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ â”‚ load_task   â”‚
â”‚             â”‚                   â”‚             â”‚                   â”‚ (PG + OS)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚
     â””â”€ XCom ìµœì í™”: <48KB = Memory, â‰¥48KB = File-based
```

### Pattern 2: Real-Time Streaming (Kafka)
```
[Producer]                    [Kafka Broker]                    [Consumers]
    â”‚                              â”‚                                â”‚
    â”‚  publish(topic, message)     â”‚                                â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚  partition-0  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ PG Consumer
    â”‚                              â”‚  partition-1  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ OS Consumer
    â”‚                              â”‚  partition-2                   â”‚
    â”‚                              â”‚                                â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’â”‚ (Consumer Group: separate)     â”‚
```

### Pattern 3: Cache-Aside (Redis)
```
[Client Request]
    â”‚
    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Check Redis    â”‚
â”‚  cache_key =    â”‚
â”‚  hash(params)   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
    â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
    â”‚         â”‚
  HIT       MISS
    â†“         â†“
  return   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Query       â”‚
           â”‚ OpenSearch  â”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                  â†“
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚ Set Redis   â”‚
           â”‚ TTL: 300s   â”‚
           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                  â†“
                return
```

---

## ğŸ’¡ Design Decisions & Trade-offs

### 1. Dual Storage (PostgreSQL + OpenSearch)
| Aspect | PostgreSQL | OpenSearch |
|--------|------------|------------|
| **Use Case** | CRUD, íŠ¸ëœì­ì…˜, ì›ë³¸ ë³´ê´€ | Full-text search, ì§‘ê³„ |
| **Consistency** | Strong | Eventually (near real-time) |
| **Query Speed** | B-tree index | Inverted index |

> **Trade-off**: ë°ì´í„° ì¼ê´€ì„± vs ê²€ìƒ‰ ì„±ëŠ¥. UPSERT with timestampë¡œ sync ê´€ë¦¬.

### 2. XCom vs File-based Transfer
- **XCom (< 48KB)**: Low latency, metadata DBì— ì €ì¥
- **File (â‰¥ 48KB)**: Airflow DB ë¶€í•˜ ë°©ì§€, cleanup_taskë¡œ 7ì¼ í›„ ìë™ ì‚­ì œ

### 3. Consumer Group Strategy
- **Separate Groups**: PG Consumerì™€ OS Consumerê°€ ê°ê° ë…ë¦½ Consumer Group
- **Benefit**: ë…ë¦½ì ì¸ ì˜¤í”„ì…‹ ê´€ë¦¬, ì¥ì•  ê²©ë¦¬

---

## ğŸš€ í–¥í›„ ë°©í–¥ì„± ë° í™•ì¥ì„±

### Phase 1: Reliability Enhancement
| ì˜ì—­ | í˜„ì¬ ìƒíƒœ | ê°œì„  ë°©í–¥ |
|------|-----------|-----------|
| **Error Handling** | Basic try-except | DLQ(Dead Letter Queue) ë„ì…, ì‹¤íŒ¨ ë©”ì‹œì§€ ë³„ë„ ì €ì¥ |
| **Monitoring** | Console logging | Prometheus + Grafana ë©”íŠ¸ë¦­ ìˆ˜ì§‘ |
| **Alerting** | ë¯¸êµ¬í˜„ | Slack/PagerDuty ì—°ë™ (`on_failure_callback`) |

### Phase 2: Scalability
| ì˜ì—­ | í˜„ì¬ ìƒíƒœ | ê°œì„  ë°©í–¥ |
|------|-----------|-----------|
| **Crawler** | Single instance | Distributed crawling (Scrapy Cluster / Celery workers) |
| **Kafka** | Single broker | Multi-broker cluster, replication factor 3 |
| **API** | Single FastAPI | Kubernetes deployment, HPA (Horizontal Pod Autoscaler) |
| **Cache** | Single Redis | Redis Cluster or Sentinel for HA |

### Phase 3: Data Quality
| ì˜ì—­ | í˜„ì¬ ìƒíƒœ | ê°œì„  ë°©í–¥ |
|------|-----------|-----------|
| **Schema Evolution** | Manual | Schema Registry (Avro/Protobuf) |
| **Data Validation** | Basic checks | Great Expectations / Pydantic strict mode |
| **Data Lineage** | ë¯¸êµ¬í˜„ | Apache Atlas / DataHub ë„ì… |

### Phase 4: Advanced Analytics
| ì˜ì—­ | ê°œì„  ë°©í–¥ |
|------|-----------|
| **Data Warehouse** | Snowflake / BigQuery ì—°ë™, historical analysis |
| **ML Pipeline** | Price prediction, demand forecasting |
| **Search Ranking** | Learning to Rank (LTR) ì ìš© |

---

## ğŸ”§ Infrastructure Recommendations

### Production Deployment
```yaml
# ê¶Œì¥ ì‚¬í•­
- PostgreSQL: RDS/Cloud SQL (Managed)
- OpenSearch: Amazon OpenSearch Service (Managed)
- Kafka: Confluent Cloud / Amazon MSK
- Airflow: Cloud Composer / MWAA
- Redis: ElastiCache / Memorystore
- API: EKS/GKE with Ingress Controller
```

### Security Considerations
- [ ] OpenSearch security í™œì„±í™” (í˜„ì¬ disabled)
- [ ] API authentication (JWT/OAuth2)
- [ ] Network segmentation (VPC)
- [ ] Secrets management (Vault/KMS)
- [ ] Rate limiting (API Gateway)

---

## ğŸ“Š Performance Metrics (Expected)

| Metric | Target | Current Estimate |
|--------|--------|------------------|
| Crawl throughput | 1000 items/hour | ~500 items/hour |
| Search latency (p99) | < 100ms | ~50ms (cached) |
| Kafka consumer lag | < 1000 | Depends on volume |
| API availability | 99.9% | Not measured |

---

## ğŸ§ª Testing Strategy (Recommended)

```python
# Unit Tests
- database/models.py â†’ CRUD operations
- kafka_client/producer.py â†’ Message serialization
- tasks/validate_task.py â†’ Validation logic

# Integration Tests  
- End-to-end: Crawler â†’ Kafka â†’ Consumer â†’ DB
- API: /search with various query params

# Load Tests
- k6/Locust for API endpoints
- Kafka producer stress test
```

---

## ğŸ“ Code Quality Observations

### Strengths âœ…
- Clear separation of concerns (routers, tasks, kafka_client)
- Docker-first development environment
- Comprehensive documentation (WEEK_*.md)
- Pydantic schema validation

### Areas for Improvement ğŸ”§
- Logging: ì²´ê³„ì ì¸ structured logging í•„ìš” (JSON format)
- Config management: `python-dotenv` ë˜ëŠ” `pydantic-settings` ê¶Œì¥
- Type hints: ì¼ë¶€ í•¨ìˆ˜ì— íƒ€ì… íŒíŠ¸ ëˆ„ë½
- Test coverage: í…ŒìŠ¤íŠ¸ ì½”ë“œ ë¶€ì¬

---

## ğŸ”— Quick Reference

### Port Mapping
| Service | Internal | External |
|---------|----------|----------|
| PostgreSQL | 5432 | 5434 |
| OpenSearch | 9200 | 9201 |
| Redis | 6379 | 6380 |
| Kafka | 29092 | 9092 |
| FastAPI | 8000 | 8000 |
| Airflow | 8080 | 8080 |
| Kafka UI | 8080 | 8088 |
| pgAdmin | 80 | 5050 |
| OS Dashboards | 5601 | 5601 |

### Essential Commands
```bash
# Start all services
docker-compose up -d

# View logs
docker-compose logs -f [service_name]

# Run API server
cd src && python api_server.py

# Run crawler manually
cd src && python v2.2_crawler.py

# Kafka consumer (separate terminals)
python -m kafka_client.consumer_postgres
python -m kafka_client.consumer_opensearch
```

---

> ğŸ’¬ **Architecture Review ìš”ì•½**: í˜„ì¬ ì•„í‚¤í…ì²˜ëŠ” MVP ìˆ˜ì¤€ì—ì„œ ì˜ ì„¤ê³„ë˜ì–´ ìˆìœ¼ë©°, Lambda Architecture íŒ¨í„´ì„ ì ì ˆíˆ ì ìš©í–ˆìŠµë‹ˆë‹¤. Production ë ˆë²¨ë¡œ ê°€ë ¤ë©´ HA, Observability, Security ì˜ì—­ì˜ ë³´ê°•ì´ í•„ìš”í•©ë‹ˆë‹¤.
